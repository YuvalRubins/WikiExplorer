<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Wiki Path Finder</title>
  <link rel="icon" type="image/png" href="favicon.png">
  <style>
    body { font-family: sans-serif; display:flex; justify-content:center; align-items:center; height:100vh; margin:0; background:#eef; }
    .container { background:white; padding:20px; border-radius:12px; width:1000px; text-align:center; box-shadow:0 5px 20px rgba(0,0,0,0.2);}
    input { padding:8px; margin:5px; width:150px; }
    button { padding:8px 15px; margin-top:10px; cursor:pointer; }
    #output { margin-top:15px; padding:10px; background:#f9f9f9; height:200px; overflow:auto; text-align:left; white-space:pre-wrap; font-family:monospace;}
  </style>
</head>
<body>
  <div class="container">
    <h2>Wiki Path Finder</h2>
    <input id="start_page" placeholder="Start page">
    <input id="end_page" placeholder="End page"><br>
    <button id="run-btn" type="button">Find Path!</button>
    <div id="output">Logs will appear here...</div>
  </div>

  <script>
    const output = document.getElementById("output");
    const app_url = "http://pyr8s8-ip-192-114-23-207.tunnelmole.net"

    document.getElementById("run-btn").addEventListener("click", () => {
      const start = encodeURIComponent(document.getElementById("start_page").value);
      const end = encodeURIComponent(document.getElementById("end_page").value);

      if(!start || !end) { output.innerText = "⚠️ Fill both boxes!"; return; }

      output.innerText = "";
      evtSource = new EventSource(`${app_url}/run?start=${start}&end=${end}`);

      evtSource.onmessage = (e) => {
        output.innerText += e.data + "\n";
        output.scrollTop = output.scrollHeight; // auto-scroll
      };

      evtSource.onerror = (e) => {
        // output.innerText += "\n❌ Connection error\n" + e + "\n" + e.data;
        evtSource.close();
      };
    });

  document.addEventListener("DOMContentLoaded", function () {
    const btn = document.getElementById("run-btn");
    const startInput = document.getElementById("start_page");
    const endInput = document.getElementById("end_page");

    // Reuse your existing run function
    function runCode() {
      btn.click(); // trigger the button click
    }

    // Listen for Enter on both inputs
    startInput.addEventListener("keydown", function (event) {
      if (event.key === "Enter") {
        runCode();
      }
    });

    endInput.addEventListener("keydown", function (event) {
      if (event.key === "Enter") {
        runCode();
      }
    });
  });
  </script>
</body>
</html>
